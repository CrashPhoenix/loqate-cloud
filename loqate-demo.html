<!-- Import Polymer -->
<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/polymer-jsonp/polymer-jsonp.html">
<link rel="import" href="bower_components/core-input/core-input.html">
<polymer-element name="loqate-demo" attributes="lqtkey inputAddress process">
  <template>
    <input is="core-input" committedValue="{{input}}">
    <h1>{{results.status}}</h1>
    <!--<h1>{{results.results[0]}}</h1>-->
    <template repeat="{{a in results.results}}">
      {{a['AVC']}}<br/>
      {{a['Address1']}}<br/>
      {{a['Address2']}}<br/>
    </template>
    
    <polymer-jsonp
      id="ajax"
      handleAs="json"
      response="{{results}}"
      on-polymer-response="{{handleResponse}}">
    </polymer-jsonp>
  </template>
  <script>
    Polymer('loqate-demo', {
      lqtkey: null,
      inputAddress: null,
      process: 'v',
      ready: function() {
        this.$.ajax.url = "https://saas.loqate.com/rest/?";
        if (this.lqtkey)
          this.$.ajax.url += "lqtkey=" + this.lqtkey + "&";
        if (this.inputAddress)
          this.$.ajax.url += "addr=" + this.inputAddress + "&";
        this.$.ajax.url += ("p=" + this.process + "&callback=");
        this.$.ajax.go();
      },
      handleResponse: function(){
        console.log(this.results.results[0]);
      }
    });
  </script>
</polymer-element>

